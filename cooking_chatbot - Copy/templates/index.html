<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cooking Chatbot</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body class="bg-light">

<div class="container mt-5">

    <!-- Top left login/logout button -->
    <div class="position-absolute top-0 start-0 m-3 d-flex align-items-center">
        {% if user %}
            <div class="dropdown">
                <button class="btn btn-outline-dark btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">
                    ğŸ‘¤ {{ user }}
                </button>
                <ul class="dropdown-menu">
                    <li><a class="dropdown-item text-danger" href="/logout">Logout</a></li>
                </ul>
            </div>
        {% else %}
            <a href="/login" class="btn btn-primary btn-sm">Login</a>
        {% endif %}
    </div>

    <h2 class="text-center mb-1">ğŸ½ï¸ Cooking Chatbot</h2>
    <p class="text-center text-muted small">Personalized Cooking Assistant</p>

    <!-- Dish Search -->
    <input type="text" id="dish" class="form-control mt-4" placeholder="Type dish name">
    <select id="suggestions" class="form-select mt-3" size="8"></select>

    <!-- Action Buttons -->
    <div class="mt-4 text-center">
        <button class="btn btn-outline-success" onclick="getDetails('ingredients')">ğŸ§‚ Ingredients</button>
        <button class="btn btn-outline-info" onclick="getDetails('recipe')">ğŸ“– Recipe</button>
        <button class="btn btn-outline-warning" onclick="getDetails('similar')">ğŸ” Similar</button>
        <button class="btn btn-outline-primary" onclick="getDetails('smart')">ğŸ§  Smart</button>
    </div>

    <!-- Output -->
    <div id="output" class="mt-4 alert alert-secondary"></div>

    <!-- Save Favorite -->
    {% if user %}
    <div class="text-end mt-2">
        <button class="btn btn-sm btn-outline-danger" onclick="saveFavorite()">â¤ï¸ Save to Favorites</button>
    </div>
    {% endif %}

    <!-- Reset / Exit -->
    <div class="mt-3">
        <button class="btn btn-secondary w-100 mb-2" onclick="resetDish()">ğŸ”„ Choose Another Dish</button>
        <button class="btn btn-danger w-100" onclick="exitApp()">ğŸšª Exit</button>
    </div>

    <!-- Favorites Panel -->
    {% if user %}
    <hr class="mt-5">
    <button class="btn btn-outline-dark w-100" onclick="toggleFavorites()">ğŸ“‚ My Favorites</button>
    <div id="favoritesPanel" class="mt-3 d-none card p-3">
        <h6>Your Favorite Dishes</h6>
        <ul id="favoritesList" class="list-group list-group-flush"></ul>
    </div>
    {% endif %}

    <!-- Add Dish Section -->
    {% if user %}
    <hr class="mt-5">
    <button class="btn btn-dark w-100" onclick="toggleAddDish()">â• Add New Dish</button>
    <div id="addDishSection" class="mt-4 d-none">
        <input type="text" id="newDishName" class="form-control mt-2" placeholder="Dish Name">
        <textarea id="newIngredients" class="form-control mt-2" rows="3" placeholder="Ingredients (comma separated)"></textarea>
        <textarea id="newRecipe" class="form-control mt-2" rows="4" placeholder="Recipe Instructions"></textarea>
        <button class="btn btn-success w-100 mt-3" onclick="addDish()">ğŸ’¾ Save Dish</button>
        <div id="addStatus" class="mt-3 alert alert-info d-none"></div>
    </div>
    {% endif %}

</div>

<!-- JS -->
<script src="{{ url_for('static', filename='js/script.js') }}"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
